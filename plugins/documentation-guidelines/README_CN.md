# Documentation Guidelines 插件

## 插件作用

文档创建和更新标准插件,避免不必要的文档生成,确保文档与代码保持同步。

**核心价值:**
- 🚫 被动创建 - 不主动创建文档,避免维护负担
- 📝 代码优先 - 优先编写清晰的代码,而不是文档
- 🔄 延迟更新 - 代码通过所有检查后再更新文档
- 🎯 按需创建 - 仅在必要或用户明确请求时创建

---

## 核心原则

### 1. 被动文档创建

**核心**: 不主动创建文档,除非有明确需求

**原因**:
- 避免创建无人维护的文档
- 文档容易过时,与代码不同步
- 代码本身应该是自文档化的
- 时间更好地花在代码质量上

### 2. 代码优先

**优先级**:
1. 编写清晰、可读的代码
2. 添加必要的代码注释
3. 编写类型定义和接口文档
4. 最后才考虑外部文档

---

## 何时不创建文档

❌ **不要创建文档**:

1. **非关键任务** - 临时代码调整、小bug修复
2. **探索性工作** - 尝试不同方法、原型开发
3. **用户未明确请求** - 完成功能后
4. **代码已经很清晰** - 清晰的命名、完整的类型定义
5. **临时代码** - 调试辅助代码、临时脚本

---

## 何时创建文档

✅ **创建文档**:

1. **用户明确请求** - "帮我写 API 使用文档"
2. **关键任务或重要功能** - 核心模块、复杂架构、重要配置、关键 API
3. **复杂设置过程** - 部署流程、环境配置、第三方服务集成
4. **面向其他开发者** - 开源项目、内部共享库、CLI 工具
5. **现有文档需要更新** - 代码变更影响到现有文档

---

## 文档更新工作流

**严格遵循此顺序**:

```
1. 完成代码实现
   ↓
2. 运行代码质量检查
   ├─ pnpm format
   ├─ pnpm lint
   ├─ pnpm typecheck
   └─ pnpm test
   ↓
3. 所有检查通过
   ↓
4. 更新相关文档
   ↓
5. 提交代码和文档
```

**为什么这个顺序?**
- 避免重复工作 - 代码在检查过程中可能变更
- 确保准确性 - 文档基于最终的、已验证的代码
- 提高效率 - 一次专注一个任务
- 减少遗漏 - 代码通过检查后不会忘记更新文档

---

## 代码内文档

### 推荐形式

#### 1. 类型定义 (TypeScript)

```typescript
/**
 * 用户注册数据
 */
interface UserRegistrationData {
  /** 用户邮箱地址 */
  email: string
  /** 密码 (最少 8 个字符) */
  password: string
}
```

#### 2. JSDoc/TSDoc 注释

```typescript
/**
 * 验证用户注册数据
 *
 * @param data - 用户注册数据
 * @returns 验证结果,包含有效性和错误信息
 *
 * @example
 * ```ts
 * const result = validateUserRegistration({
 *   email: 'user@example.com',
 *   password: 'securepass123'
 * })
 * ```
 */
function validateUserRegistration(data: UserRegistrationData): ValidationResult {
  // ...
}
```

#### 3. 内联注释 (仅用于复杂逻辑)

```typescript
// ✅ 好的注释: 解释为什么
// 使用 bcrypt 而不是 md5,因为 md5 已被证明不安全
const hashedPassword = await bcrypt.hash(password, 10)

// ❌ 不必要的注释
// 设置 username 为 username
user.name = username
```

---

## 文档类型

### 1. README.md

**何时创建**: 新项目初始化 (如果用户请求)、开源项目

**必须包含**:
- 项目介绍
- 安装说明
- 基本使用示例
- 开发指南链接

### 2. API 文档

**何时创建**: 提供公共 API、用户明确请求、API 复杂且非直观

**推荐格式**:
- OpenAPI/Swagger 规范
- JSDoc/TSDoc 注释
- 专门的 API.md 文件

### 3. CHANGELOG.md

**何时创建**: 发布版本时、用户需要了解变更历史

**推荐格式**: 遵循 [Keep a Changelog](https://keepachangelog.com/)

---

## 文档维护

### 保持文档同步

**策略**:
1. **代码变更时检查相关文档**
   - 修改 API → 检查 API 文档
   - 变更配置 → 检查配置文档

2. **在 PR 中要求文档更新**
   - PR 检查清单包含"文档已更新"
   - 代码审查时检查文档

3. **定期审查文档**
   - 季度或半年审查
   - 删除过时文档
   - 更新陈旧信息

---

## 示例场景

### 新功能完成后

```
场景: 实现了用户认证功能

✅ 正确流程:
1. 完成代码实现
2. 添加测试
3. 运行所有质量检查并通过
4. 检查现有文档是否需要更新
5. 仅在用户请求时创建文档;否则只更新现有文档
6. 提交代码
```

### API 端点变更

```
场景: 修改了 /api/users 端点的响应格式

✅ 正确流程:
1. 修改代码
2. 更新测试
3. 运行质量检查 → 通过
4. 检查 docs/API.md 是否存在
   ├─ 存在 → 更新端点文档
   └─ 不存在 → 询问用户是否需要创建
5. 在 CHANGELOG.md 中记录变更 (如果存在)
6. 提交代码和文档更新
```

---

## 推荐工具

- **JSDoc/TSDoc**: 代码内文档
- **Docusaurus**: 文档网站 (React-based)
- **VitePress**: 文档网站 (Vue-based)
- **Swagger/OpenAPI**: API 文档
- **Storybook**: UI 组件文档

---

## 总结

| 原则 | 描述 |
|------|------|
| **被动创建** | 不主动创建文档 |
| **代码优先** | 优先编写清晰代码 |
| **延迟更新** | 代码通过检查后再更新文档 |
| **保持同步** | 代码变更时检查相关文档 |
| **及时清理** | 删除过时和无关文档 |

---

## 常见问题

**Q: 什么时候应该创建 README?**
A: 1) 用户明确请求 2) 开源项目 3) 内部共享库需要说明时

**Q: API 变更是否总是需要更新文档?**
A: 如果有 API 文档存在,则必须更新。如果没有,询问用户是否需要创建。

**Q: 代码注释和外部文档哪个更重要?**
A: 代码注释更重要。外部文档容易过时,代码注释更接近代码本身。

---

## 相关插件

- **code-quality-standards** - 质量检查在文档更新之前

---

## 作者

- 作者: LeekJay
- 邮箱: leekjay@foxmail.com
- 仓库: https://github.com/LeekJay/claude-skills-plugin
